---
// LicenseGenerator.astro - Featæ¡†æ¶Licenseç”Ÿæˆå™¨
---

<div class="license-generator">
    <div class="generator-header">
        <h2>ğŸ” Feat License ç”Ÿæˆå™¨</h2>
        <p>ä¸º Feat æ¡†æ¶ç”Ÿæˆå•†ä¸šæˆæƒè®¸å¯è¯</p>
    </div>

    <div class="form-section">
        <div class="input-group">
            <label for="licenseName">æˆæƒå¯¹è±¡åç§°:</label>
            <input 
                type="text" 
                id="licenseName" 
                placeholder="è¯·è¾“å…¥æˆæƒå¯¹è±¡åç§°ï¼Œå¦‚ï¼šsmartbootå¼€æºç»„ç»‡"
                value="smartbootå¼€æºç»„ç»‡"
            />
        </div>

        <div class="input-group">
            <label for="licenseNumber">è®¸å¯è¯ç¼–å·:</label>
            <div class="input-with-button">
                <input 
                    type="text" 
                    id="licenseNumber" 
                    placeholder="ä¼ä¸šç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç æˆ–å¼€æºé¡¹ç›®ä»“åº“åœ°å€ï¼Œå¦‚ï¼š91110000123456789X æˆ– github.com/smartboot/feat"
                />
                <button id="autoGenerateBtn" class="auto-generate-btn">æ—¶é—´ç¼–å·</button>
            </div>
            <div class="license-examples">
                <span class="example-label">ç¤ºä¾‹ï¼š</span>
                <code class="example-code">91110000123456789X</code>ï¼ˆç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼‰
                <code class="example-code">github.com/smartboot/feat</code>ï¼ˆä»“åº“åœ°å€ï¼‰
                <code class="example-code">20241201000001</code>ï¼ˆæ—¶é—´ç¼–å·ï¼‰
            </div>
        </div>

        <div class="button-group">
            <button id="generateBtn" class="generate-btn">ç”Ÿæˆè®¸å¯è¯</button>
            <button id="verifyBtn" class="verify-btn" disabled>éªŒè¯è®¸å¯è¯</button>
        </div>
    </div>

    <div class="results-section" id="resultsSection" style="display: none;">
        <div class="result-group">
            <h3>ğŸ“‹ feat_users.yaml é…ç½®:</h3>
            <pre id="featUsersConfig" class="config-output"></pre>
            <button class="copy-btn" data-target="featUsersConfig">å¤åˆ¶</button>
        </div>

        <div class="result-group">
            <h3>âš™ï¸ feat.yml é…ç½®:</h3>
            <pre id="featYmlConfig" class="config-output"></pre>
            <button class="copy-btn" data-target="featYmlConfig">å¤åˆ¶</button>
        </div>

        <div class="result-group">
            <h3>ğŸ”‘ å¯†é’¥ä¿¡æ¯:</h3>
            <div class="key-info">
                <div class="key-item">
                    <label>å…¬é’¥ (Public Key):</label>
                    <textarea id="publicKey" readonly></textarea>
                    <button class="copy-btn" data-target="publicKey">å¤åˆ¶</button>
                </div>
                <div class="key-item">
                    <label>ç§é’¥ (Private Key) - è¯·å¦¥å–„ä¿ç®¡:</label>
                    <textarea id="privateKey" readonly></textarea>
                    <button class="copy-btn" data-target="privateKey">å¤åˆ¶</button>
                </div>
            </div>
        </div>

        <div class="verification-section" id="verificationSection">
            <h3>âœ… éªŒè¯ç»“æœ:</h3>
            <div id="verificationResult" class="verification-result"></div>
        </div>

        <div class="test-section">
            <h3>ğŸ§ª å…¼å®¹æ€§æµ‹è¯•:</h3>
            <p class="test-description">ä½¿ç”¨é»˜è®¤æµ‹è¯•æ•°æ® "smartbootå¼€æºç»„ç»‡" éªŒè¯ä¸Javaç‰ˆæœ¬çš„å…¼å®¹æ€§</p>
            <button id="testBtn" class="test-btn">è¿è¡Œå…¼å®¹æ€§æµ‹è¯•</button>
            <div id="testResult" class="test-result" style="display: none;"></div>
        </div>
    </div>
</div>

<script>
import { ec as EC } from 'elliptic';

class LicenseGenerator {
    constructor() {
        this.ec = new EC('p256');
        this.keyPair = null;
        this.signature = null;
        this.licenseName = '';
        this.licenseNumber = '';
        
        this.initEventListeners();
        this.generateLicenseNumber();
    }

    initEventListeners() {
        const generateBtn = document.getElementById('generateBtn');
        const verifyBtn = document.getElementById('verifyBtn');
        const testBtn = document.getElementById('testBtn');
        const autoGenerateBtn = document.getElementById('autoGenerateBtn');
        const copyBtns = document.querySelectorAll('.copy-btn');
        const licenseNameInput = document.getElementById('licenseName');
        const licenseNumberInput = document.getElementById('licenseNumber');

        generateBtn?.addEventListener('click', () => this.generateLicense());
        verifyBtn?.addEventListener('click', () => this.verifyLicense());
        testBtn?.addEventListener('click', () => this.runCompatibilityTest());
        autoGenerateBtn?.addEventListener('click', () => this.generateLicenseNumber());
        
        copyBtns.forEach(btn => {
            btn.addEventListener('click', (e) => this.copyToClipboard(e.target.dataset.target));
        });

        licenseNameInput?.addEventListener('input', (e) => {
            this.licenseName = e.target.value;
        });
        
        licenseNumberInput?.addEventListener('input', (e) => {
            this.licenseNumber = e.target.value;
        });
    }

    generateLicenseNumber() {
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        this.licenseNumber = `${year}${month}${day}000001`;
        
        const licenseNumberInput = document.getElementById('licenseNumber');
        if (licenseNumberInput) {
            licenseNumberInput.value = this.licenseNumber;
        }
    }

    // éªŒè¯è®¸å¯è¯ç¼–å·æ ¼å¼
    // validateLicenseNumber(licenseNumber) {
    //     // 1. ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼ˆ18ä½ï¼šå‰17ä½æ˜¯æ•°å­—ï¼Œæœ€å1ä½æ˜¯æ•°å­—æˆ–å¤§å†™å­—æ¯Xï¼‰
    //     const creditCodePattern = /^[0-9]{17}[0-9X]$/;
    //     if (creditCodePattern.test(licenseNumber)) {
    //         return true;
    //     }
    //
    //     // 2. ä»“åº“åœ°å€æ ¼å¼ï¼ˆæ”¯æŒ github.com/user/repoã€gitlab.com/user/repo ç­‰ï¼‰
    //     const repoUrlPattern = /^[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/[a-zA-Z0-9._-]+/[a-zA-Z0-9._-]+$/;
    //     if (repoUrlPattern.test(licenseNumber)) {
    //         return true;
    //     }
    //
    //     // 3. æ—¶é—´ç¼–å·æ ¼å¼ï¼ˆ14ä½æ•°å­—ï¼‰
    //     const timeCodePattern = /^\d{14}$/;
    //     if (timeCodePattern.test(licenseNumber)) {
    //         return true;
    //     }
    //
    //     // 4. æ”¯æŒå…¶ä»–è‡ªå®šä¹‰æ ¼å¼ï¼ˆé•¿åº¦åœ¨ 6-50 ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼‰
    //     if (licenseNumber.length >= 6 && licenseNumber.length <= 50) {
    //         return true;
    //     }
    //
    //     return false;
    // }

    async generateLicense() {
        try {
            // è·å–æˆæƒåç§°
            const licenseNameInput = document.getElementById('licenseName');
            this.licenseName = licenseNameInput?.value || 'smartbootå¼€æºç»„ç»‡';
            
            // è·å–è®¸å¯è¯ç¼–å·
            const licenseNumberInput = document.getElementById('licenseNumber');
            this.licenseNumber = licenseNumberInput?.value || '';

            if (!this.licenseName.trim()) {
                alert('è¯·è¾“å…¥æˆæƒå¯¹è±¡åç§°');
                return;
            }
            
            if (!this.licenseNumber.trim()) {
                alert('è¯·è¾“å…¥è®¸å¯è¯ç¼–å·ï¼ˆç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ã€ä»“åº“åœ°å€æˆ–æ—¶é—´ç¼–å·ï¼‰');
                return;
            }
            
            // éªŒè¯è®¸å¯è¯ç¼–å·æ ¼å¼ï¼ˆæ”¯æŒå¤šç§æ ¼å¼ï¼‰
            // if (!this.validateLicenseNumber(this.licenseNumber)) {
            //     alert('è®¸å¯è¯ç¼–å·æ ¼å¼ä¸æ­£ç¡®ï¼\n\næ”¯æŒçš„æ ¼å¼ï¼š\n1. ç»Ÿä¸€ç¤¾ä¼šä¿¡ç”¨ä»£ç ï¼ˆ18ä½ï¼‰\n2. ä»“åº“åœ°å€ï¼ˆå¦‚ github.com/user/repoï¼‰\n3. æ—¶é—´ç¼–å·ï¼ˆ14ä½æ•°å­—ï¼‰');
            //     return;
            // }

            // 1. ç”Ÿæˆ ECDSA å¯†é’¥å¯¹ (P-256 æ›²çº¿ï¼Œå¯¹åº”Javaçš„EC 256ä½)
            this.keyPair = this.ec.genKeyPair();

            // 2. è·å–å…¬é’¥ (DERæ ¼å¼ï¼ŒBase64ç¼–ç  - åŒ¹é…Javaçš„å®ç°)
            const publicKeyDER = this.getPublicKeyDER();
            const publicKeyBase64 = this.arrayBufferToBase64(publicKeyDER);

            // 3. å¯¹æˆæƒåç§°è¿›è¡Œç­¾å (åŒ¹é…Javaçš„SHA256withECDSA)
            // Javaä½¿ç”¨çš„æ˜¯data.getBytes()ï¼Œé»˜è®¤ä½¿ç”¨ç³»ç»Ÿç¼–ç ï¼Œè¿™é‡Œä½¿ç”¨UTF-8ç¡®ä¿ä¸€è‡´æ€§
            const messageBytes = new TextEncoder().encode(this.licenseName);
            const messageHash = await this.sha256(messageBytes);
            this.signature = this.keyPair.sign(Array.from(new Uint8Array(messageHash)));
            const signatureBase64 = this.signatureToBase64(this.signature);

            // 4. æ˜¾ç¤ºç»“æœ
            this.displayResults(publicKeyBase64, signatureBase64);

            // å¯ç”¨éªŒè¯æŒ‰é’®
            document.getElementById('verifyBtn').disabled = false;

        } catch (error) {
            console.error('ç”Ÿæˆè®¸å¯è¯æ—¶å‡ºé”™:', error);
            alert('ç”Ÿæˆè®¸å¯è¯æ—¶å‡ºé”™: ' + error.message);
        }
    }

    // å°†æ¤­åœ†æ›²çº¿å…¬é’¥è½¬æ¢ä¸ºDERæ ¼å¼ (åŒ¹é…Javaçš„X509EncodedKeySpecæ ¼å¼)
    getPublicKeyDER() {
        const publicKeyPoint = this.keyPair.getPublic();
        const x = publicKeyPoint.getX().toArray('be', 32);
        const y = publicKeyPoint.getY().toArray('be', 32);
        
        // P-256æ›²çº¿çš„DERç¼–ç æ ¼å¼
        // SEQUENCE { SEQUENCE { OBJECT IDENTIFIER, NULL }, BIT STRING }
        const algorithmIdentifier = new Uint8Array([
            0x30, 0x13, // SEQUENCE, length 19
            0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x02, 0x01, // ecPublicKey OID
            0x06, 0x08, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x03, 0x01, 0x07 // prime256v1 OID
        ]);
        
        const publicKeyBytes = new Uint8Array([0x04, ...x, ...y]); // æœªå‹ç¼©æ ¼å¼
        const bitString = new Uint8Array([0x03, publicKeyBytes.length + 1, 0x00, ...publicKeyBytes]);
        
        const derBytes = new Uint8Array([
            0x30, algorithmIdentifier.length + bitString.length, // SEQUENCE
            ...algorithmIdentifier,
            ...bitString
        ]);
        
        return derBytes;
    }

    // SHA256 å“ˆå¸Œå‡½æ•°
    async sha256(data) {
        return await crypto.subtle.digest('SHA-256', data);
    }

    // å°†ç­¾åè½¬æ¢ä¸ºBase64æ ¼å¼
    signatureToBase64(signature) {
        // å°†rå’Œså€¼è½¬æ¢ä¸ºDERç¼–ç çš„ASN.1æ ¼å¼ (åŒ¹é…Javaçš„ç­¾åæ ¼å¼)
        const r = signature.r.toArray('be');
        const s = signature.s.toArray('be');
        
        const rLen = r.length;
        const sLen = s.length;
        
        // DERç¼–ç : SEQUENCE { INTEGER r, INTEGER s }
        const derSig = new Uint8Array([
            0x30, rLen + sLen + 4, // SEQUENCE
            0x02, rLen, ...r,      // INTEGER r
            0x02, sLen, ...s       // INTEGER s
        ]);
        
        return this.arrayBufferToBase64(derSig);
    }

    // ArrayBufferè½¬Base64
    arrayBufferToBase64(buffer) {
        const bytes = new Uint8Array(buffer);
        let binary = '';
        for (let i = 0; i < bytes.byteLength; i++) {
            binary += String.fromCharCode(bytes[i]);
        }
        return btoa(binary);
    }

    // æ˜¾ç¤ºç”Ÿæˆç»“æœ
    displayResults(publicKeyBase64, signatureBase64) {
        // feat_users.yaml é…ç½®
        const featUsersConfig = `users:
  ${this.licenseNumber}:
    num: ${this.licenseNumber}
    name: ${this.licenseName}
    license: ${signatureBase64}`;

        // feat.yml é…ç½®
        const featYmlConfig = `license: ${this.licenseNumber}_${publicKeyBase64}`;

        // æ˜¾ç¤ºé…ç½®
        document.getElementById('featUsersConfig').textContent = featUsersConfig;
        document.getElementById('featYmlConfig').textContent = featYmlConfig;
        
        // æ˜¾ç¤ºå¯†é’¥ä¿¡æ¯
        document.getElementById('publicKey').value = publicKeyBase64;
        document.getElementById('privateKey').value = this.keyPair.getPrivate('hex');
        
        // æ˜¾ç¤ºç»“æœåŒºåŸŸ
        document.getElementById('resultsSection').style.display = 'block';
    }

    // éªŒè¯è®¸å¯è¯
    async verifyLicense() {
        try {
            if (!this.keyPair || !this.signature) {
                alert('è¯·å…ˆç”Ÿæˆè®¸å¯è¯');
                return;
            }

            // å¯¹æˆæƒåç§°è¿›è¡Œå“ˆå¸Œ
            const messageBytes = new TextEncoder().encode(this.licenseName);
            const messageHash = await this.sha256(messageBytes);
            
            // éªŒè¯ç­¾å
            const isValid = this.keyPair.verify(Array.from(new Uint8Array(messageHash)), this.signature);
            
            const resultDiv = document.getElementById('verificationResult');
            if (isValid) {
                resultDiv.innerHTML = '<span class="success">âœ… è®¸å¯è¯éªŒè¯é€šè¿‡ï¼</span>';
                resultDiv.className = 'verification-result success';
            } else {
                resultDiv.innerHTML = '<span class="error">âŒ è®¸å¯è¯éªŒè¯å¤±è´¥ï¼</span>';
                resultDiv.className = 'verification-result error';
            }

        } catch (error) {
            console.error('éªŒè¯è®¸å¯è¯æ—¶å‡ºé”™:', error);
            alert('éªŒè¯è®¸å¯è¯æ—¶å‡ºé”™: ' + error.message);
        }
    }

    // å¤åˆ¶åˆ°å‰ªè´´æ¿
    async copyToClipboard(targetId) {
        try {
            const element = document.getElementById(targetId);
            const text = element.tagName === 'TEXTAREA' ? element.value : element.textContent;
            
            await navigator.clipboard.writeText(text);
            
            // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
            const btn = document.querySelector(`[data-target="${targetId}"]`);
            const originalText = btn.textContent;
            btn.textContent = 'å·²å¤åˆ¶!';
            btn.style.background = '#10b981';
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
            }, 2000);
            
        } catch (error) {
            alert('å¤åˆ¶å¤±è´¥: ' + error.message);
        }
    }

    // å…¼å®¹æ€§æµ‹è¯•
    async runCompatibilityTest() {
        const testResultDiv = document.getElementById('testResult');
        testResultDiv.style.display = 'block';
        testResultDiv.innerHTML = '<div class="loading">ğŸ”„ è¿è¡Œæµ‹è¯•ä¸­...</div>';
        
        try {
            // ä½¿ç”¨å›ºå®šçš„æµ‹è¯•æ•°æ®
            const testName = 'smartbootå¼€æºç»„ç»‡';
            
            // ç”Ÿæˆå¤šä¸ªç­¾åè¿›è¡Œå¯¹æ¯”
            const results = [];
            for (let i = 0; i < 3; i++) {
                const keyPair = this.ec.genKeyPair();
                const messageBytes = new TextEncoder().encode(testName);
                const messageHash = await this.sha256(messageBytes);
                const signature = keyPair.sign(Array.from(new Uint8Array(messageHash)));
                
                // éªŒè¯ç­¾å
                const isValid = keyPair.verify(Array.from(new Uint8Array(messageHash)), signature);
                
                results.push({
                    iteration: i + 1,
                    publicKey: this.arrayBufferToBase64(this.getPublicKeyDERFromKeyPair(keyPair)),
                    signature: this.signatureToBase64(signature),
                    valid: isValid
                });
            }
            
            // æ˜¾ç¤ºæµ‹è¯•ç»“æœ
            let html = `
                <div class="test-summary">
                    <h4>ğŸ“¦ æµ‹è¯•ç»“æœæ‘˜è¦</h4>
                    <p><strong>æµ‹è¯•æ•°æ®:</strong> "${testName}"</p>
                    <p><strong>ç”Ÿæˆæ¬¡æ•°:</strong> ${results.length}</p>
                    <p><strong>éªŒè¯ç»“æœ:</strong> ${results.filter(r => r.valid).length}/${results.length} æˆåŠŸ</p>
                </div>
                <div class="test-details">
                    <h4>ğŸ” è¯¦ç»†ç»“æœ</h4>
            `;
            
            results.forEach(result => {
                html += `
                    <div class="test-item ${result.valid ? 'success' : 'error'}">
                        <h5>ç¬¬ ${result.iteration} æ¬¡æµ‹è¯• ${result.valid ? 'âœ…' : 'âŒ'}</h5>
                        <div class="test-data">
                            <div><strong>å…¬é’¥:</strong> <code>${result.publicKey.substring(0, 40)}...</code></div>
                            <div><strong>ç­¾å:</strong> <code>${result.signature.substring(0, 40)}...</code></div>
                            <div><strong>éªŒè¯:</strong> <span class="status ${result.valid ? 'success' : 'error'}">${result.valid ? 'é€šè¿‡' : 'å¤±è´¥'}</span></div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            if (results.every(r => r.valid)) {
                html += '<div class="test-conclusion success">âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ç®—æ³•å®ç°æ­£ç¡®ã€‚</div>';
            } else {
                html += '<div class="test-conclusion error">âŒ å­˜åœ¨æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç®—æ³•å®ç°ã€‚</div>';
            }
            
            testResultDiv.innerHTML = html;
            
        } catch (error) {
            testResultDiv.innerHTML = `<div class="test-conclusion error">âŒ æµ‹è¯•å¤±è´¥: ${error.message}</div>`;
        }
    }

    // ä»å¯†é’¥å¯¹è·å–DERæ ¼å¼å…¬é’¥
    getPublicKeyDERFromKeyPair(keyPair) {
        const publicKeyPoint = keyPair.getPublic();
        const x = publicKeyPoint.getX().toArray('be', 32);
        const y = publicKeyPoint.getY().toArray('be', 32);
        
        // P-256æ›²çº¿çš„DERç¼–ç æ ¼å¼
        const algorithmIdentifier = new Uint8Array([
            0x30, 0x13,
            0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x02, 0x01,
            0x06, 0x08, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x03, 0x01, 0x07
        ]);
        
        const publicKeyBytes = new Uint8Array([0x04, ...x, ...y]);
        const bitString = new Uint8Array([0x03, publicKeyBytes.length + 1, 0x00, ...publicKeyBytes]);
        
        const derBytes = new Uint8Array([
            0x30, algorithmIdentifier.length + bitString.length,
            ...algorithmIdentifier,
            ...bitString
        ]);
        
        return derBytes;
    }
}

// åˆå§‹åŒ–è®¸å¯è¯ç”Ÿæˆå™¨
document.addEventListener('DOMContentLoaded', () => {
    new LicenseGenerator();
});
</script>

<style>
.license-generator {
    max-width: 1000px;
    margin: 2rem auto;
    padding: 2rem;
    background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
    border-radius: 16px;
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
}

.generator-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1.5rem;
    border-bottom: 2px solid #e2e8f0;
}

.generator-header h2 {
    color: #1e293b;
    margin-bottom: 0.5rem;
    font-size: 2rem;
    font-weight: 700;
}

.generator-header p {
    color: #64748b;
    font-size: 1.1rem;
}

.form-section {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    margin-bottom: 2rem;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.input-group {
    margin-bottom: 1.5rem;
}

.input-group label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #374151;
}

.input-group input {
    width: 100%;
    padding: 0.75rem 1rem;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.3s ease;
}

.input-group input:focus {
    outline: none;
    border-color: #3b82f6;
    box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
}

.input-with-button {
    display: flex;
    gap: 0.5rem;
    align-items: center;
}

.input-with-button input {
    flex: 1;
}

.auto-generate-btn {
    padding: 0.75rem 1rem;
    background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 0.9rem;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.3s ease;
    white-space: nowrap;
}

.auto-generate-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
}

.license-examples {
    margin-top: 0.75rem;
    padding: 0.75rem;
    background: #f8fafc;
    border-radius: 6px;
    border: 1px solid #e2e8f0;
    font-size: 0.85rem;
    line-height: 1.5;
}

.example-label {
    font-weight: 600;
    color: #374151;
}

.example-code {
    background: #e2e8f0;
    padding: 0.2rem 0.4rem;
    border-radius: 3px;
    font-family: 'Monaco', 'Menlo', monospace;
    color: #4f46e5;
    margin: 0 0.25rem;
    display: inline-block;
}

.input-group input[readonly] {
    background-color: #f9fafb;
    color: #6b7280;
}

.button-group {
    display: flex;
    gap: 1rem;
    justify-content: center;
    margin-top: 2rem;
}

.generate-btn, .verify-btn {
    padding: 0.75rem 2rem;
    border: none;
    border-radius: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.generate-btn {
    background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
    color: white;
}

.generate-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(59, 130, 246, 0.3);
}

.verify-btn {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    color: white;
}

.verify-btn:hover:not(:disabled) {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(16, 185, 129, 0.3);
}

.verify-btn:disabled {
    background: #d1d5db;
    cursor: not-allowed;
}

.results-section {
    background: white;
    padding: 2rem;
    border-radius: 12px;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
}

.result-group {
    margin-bottom: 2rem;
    position: relative;
}

.result-group h3 {
    color: #1e293b;
    margin-bottom: 1rem;
    font-size: 1.25rem;
}

.config-output {
    background: #1e293b;
    color: #e2e8f0;
    padding: 1.5rem;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.9rem;
    line-height: 1.5;
    overflow-x: auto;
    margin-bottom: 0.5rem;
    white-space: pre-wrap;
}

.key-info {
    display: grid;
    gap: 1.5rem;
}

.key-item {
    position: relative;
}

.key-item label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: #374151;
}

.key-item textarea {
    width: 100%;
    height: 80px;
    padding: 0.75rem;
    border: 2px solid #e5e7eb;
    border-radius: 8px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.85rem;
    resize: vertical;
    background: #f9fafb;
}

.copy-btn {
    position: absolute;
    top: 0;
    right: 0;
    padding: 0.5rem 1rem;
    background: #6b7280;
    color: white;
    border: none;
    border-radius: 6px;
    font-size: 0.85rem;
    cursor: pointer;
    transition: background 0.3s ease;
}

.copy-btn:hover {
    background: #374151;
}

.verification-section {
    padding: 1.5rem;
    background: #f8fafc;
    border-radius: 8px;
    border: 2px solid #e2e8f0;
}

.verification-result {
    padding: 1rem;
    border-radius: 6px;
    font-weight: 600;
    text-align: center;
}

.verification-result.success {
    background: #d1fae5;
    color: #065f46;
    border: 1px solid #a7f3d0;
}

.verification-result.error {
    background: #fee2e2;
    color: #991b1b;
    border: 1px solid #fca5a5;
}

.test-section {
    padding: 1.5rem;
    background: #fefce8;
    border-radius: 8px;
    border: 2px solid #fde047;
    margin-top: 1rem;
}

.test-description {
    color: #a16207;
    margin-bottom: 1rem;
    font-style: italic;
}

.test-btn {
    padding: 0.75rem 1.5rem;
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.test-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 20px rgba(245, 158, 11, 0.3);
}

.test-result {
    margin-top: 1.5rem;
    padding: 1.5rem;
    background: white;
    border-radius: 8px;
    border: 1px solid #e5e7eb;
}

.loading {
    text-align: center;
    color: #6b7280;
    font-weight: 600;
}

.test-summary {
    padding: 1rem;
    background: #f3f4f6;
    border-radius: 6px;
    margin-bottom: 1rem;
}

.test-summary h4 {
    margin-bottom: 0.5rem;
    color: #374151;
}

.test-summary p {
    margin: 0.25rem 0;
    color: #6b7280;
}

.test-details h4 {
    margin-bottom: 1rem;
    color: #374151;
}

.test-item {
    padding: 1rem;
    margin-bottom: 1rem;
    border-radius: 6px;
    border: 1px solid #e5e7eb;
}

.test-item.success {
    background: #f0fdf4;
    border-color: #bbf7d0;
}

.test-item.error {
    background: #fef2f2;
    border-color: #fecaca;
}

.test-item h5 {
    margin-bottom: 0.75rem;
    color: #374151;
}

.test-data div {
    margin-bottom: 0.5rem;
    font-size: 0.9rem;
}

.test-data code {
    background: #f9fafb;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    font-family: 'Monaco', 'Menlo', monospace;
    color: #6b7280;
}

.status.success {
    color: #16a34a;
    font-weight: 600;
}

.status.error {
    color: #dc2626;
    font-weight: 600;
}

.test-conclusion {
    padding: 1rem;
    border-radius: 6px;
    text-align: center;
    font-weight: 600;
    margin-top: 1rem;
}

.test-conclusion.success {
    background: #dcfce7;
    color: #16a34a;
    border: 1px solid #bbf7d0;
}

.test-conclusion.error {
    background: #fee2e2;
    color: #dc2626;
    border: 1px solid #fca5a5;
}

@media (max-width: 768px) {
    .license-generator {
        margin: 1rem;
        padding: 1rem;
    }
    
    .button-group {
        flex-direction: column;
    }
    
    .key-info {
        grid-template-columns: 1fr;
    }
    
    .input-with-button {
        flex-direction: column;
        gap: 0.75rem;
    }
    
    .input-with-button input {
        order: 1;
    }
    
    .auto-generate-btn {
        order: 2;
        align-self: stretch;
    }
    
    .license-examples {
        font-size: 0.75rem;
    }
    
    .example-code {
        display: block;
        margin: 0.25rem 0;
        word-break: break-all;
    }
}
</style>