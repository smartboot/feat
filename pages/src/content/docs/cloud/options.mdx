---
title: 3.3 CloudOptions é…ç½® ğŸŒ
description: ä¸€æ¬¾ä¼ä¸šçº§ Web æœåŠ¡å¼€å‘æ¡†æ¶
sidebar:
    order: 3
---

import CheckAuthorize from '../../../components/CheckAuthorize.astro'
import {Aside, TabItem, Tabs} from "@astrojs/starlight/components";

<CheckAuthorize/>

# CloudOptions é…ç½®

CloudOptions å®šä¹‰äº† Feat Cloud æœåŠ¡çš„é…ç½®ä¿¡æ¯ï¼Œå®ƒç»§æ‰¿è‡ª ServerOptionsï¼Œå› æ­¤é™¤äº†è‡ªèº«ç‰¹æœ‰çš„é…ç½®é¡¹å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ ServerOptions ä¸­çš„æ‰€æœ‰é…ç½®é¡¹ã€‚

## CloudOptions ç‰¹æœ‰é…ç½®é¡¹

### packages
**ç±»å‹**: `String[]`

**é»˜è®¤å€¼**: `null`

å®šä¹‰äº† Feat Cloud å¯åŠ¨æ—¶åŠ è½½çš„å®ä¾‹åŒ…è·¯å¾„ï¼Œé»˜è®¤æ‰«æ classpath ä¸‹çš„æ‰€æœ‰å®ä¾‹åŒ…ã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    options.setPackages("com.example.controller", "com.example.service");
});
```

**æœ€ä½³å®è·µ**:
- æ˜ç¡®æŒ‡å®šåŒ…è·¯å¾„å¯ä»¥æé«˜åº”ç”¨å¯åŠ¨é€Ÿåº¦ï¼Œå‡å°‘ä¸å¿…è¦çš„ç±»æ‰«æ
- åœ¨å¤§å‹é¡¹ç›®ä¸­ï¼Œå»ºè®®æŒ‰åŠŸèƒ½æ¨¡å—åˆ’åˆ†åŒ…ï¼Œå¹¶åªåŠ è½½éœ€è¦çš„åŒ…

### externalBeans
**ç±»å‹**: `Map<String, Object>`

**é»˜è®¤å€¼**: `ç©ºMap`

å®šä¹‰äº† Feat Cloud å¯åŠ¨æ—¶åŠ è½½çš„å¤–éƒ¨ Bean é…ç½®ï¼Œå¯ä»¥é€šè¿‡ `addExternalBean` æ–¹æ³•æ·»åŠ å¤–éƒ¨ Beanã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    options.addExternalBean("dataSource", createDataSource());
    options.addExternalBean("redisClient", createRedisClient());
});
```

**æœ€ä½³å®è·µ**:
- ä½¿ç”¨æœ‰æ„ä¹‰çš„é”®åï¼Œä¾¿äºåœ¨åº”ç”¨ä¸­å¼•ç”¨
- å¤–éƒ¨Beané€šå¸¸ç”¨äºæ³¨å…¥ç¬¬ä¸‰æ–¹æœåŠ¡æˆ–èµ„æºï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± ã€ç¼“å­˜å®¢æˆ·ç«¯ç­‰
- æ³¨æ„é¿å…Beanåç§°å†²çªï¼Œå¦åˆ™ä¼šæŠ›å‡ºå¼‚å¸¸

## ä» ServerOptions ç»§æ‰¿çš„é‡è¦é…ç½®é¡¹

### serverName
**ç±»å‹**: `String`

**é»˜è®¤å€¼**: `"feat"`

è®¾ç½®æœåŠ¡å™¨åç§°ï¼Œä¼šåœ¨HTTPå“åº”å¤´çš„Serverå­—æ®µä¸­æ˜¾ç¤ºã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    options.serverName("my-application-v1.0");
});
```

### threadNum
**ç±»å‹**: `int`

**é»˜è®¤å€¼**: `å¯ç”¨å¤„ç†å™¨æ•°é‡ï¼ˆè‡³å°‘ä¸º2ï¼‰`

è®¾ç½®æœåŠ¡çº¿ç¨‹æ•°ï¼Œå½±å“æœåŠ¡å™¨å¤„ç†è¯·æ±‚çš„å¹¶å‘èƒ½åŠ›ã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    options.threadNum(16);
});
```

**æœ€ä½³å®è·µ**:
- å¯¹äºIOå¯†é›†å‹åº”ç”¨ï¼Œå¯ä»¥é€‚å½“å¢åŠ çº¿ç¨‹æ•°
- å¯¹äºCPUå¯†é›†å‹åº”ç”¨ï¼Œå»ºè®®è®¾ç½®ä¸ºCPUæ ¸å¿ƒæ•°çš„1-2å€

### idleTimeout
**ç±»å‹**: `long`

**é»˜è®¤å€¼**: `60000`ï¼ˆæ¯«ç§’ï¼Œå³1åˆ†é’Ÿï¼‰

è®¾ç½®è¿æ¥ç©ºé—²è¶…æ—¶æ—¶é—´ï¼Œè¶…è¿‡è¯¥æ—¶é—´æœªæ”¶åˆ°æ•°æ®çš„è¿æ¥å°†è¢«å…³é—­ã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    // è®¾ç½®ä¸º30ç§’
    options.setIdleTimeout(30000);
});
```

### debug
**ç±»å‹**: `boolean`

**é»˜è®¤å€¼**: `false`

å¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œä¼šæ‰“å°è¯·æ±‚å’Œå“åº”çš„ç æµä¿¡æ¯ï¼Œä¾¿äºæ’æŸ¥é—®é¢˜ã€‚

**ä½¿ç”¨ç¤ºä¾‹**:
```java
FeatCloud.cloudServer(options -> {
    options.debug(true);
});
```

<Aside type="caution">
  è°ƒè¯•æ¨¡å¼ä¼šå½±å“æ€§èƒ½ï¼Œå»ºè®®ä»…åœ¨å¼€å‘ç¯å¢ƒä¸­å¯ç”¨ã€‚
</Aside>

## å®Œæ•´é…ç½®ç¤ºä¾‹

ä»¥ä¸‹æ˜¯ä¸€ä¸ªç»¼åˆä½¿ç”¨ CloudOptions é…ç½®çš„ç¤ºä¾‹ï¼š

```java
import tech.smartboot.feat.cloud.FeatCloud;
import tech.smartboot.feat.core.server.HttpServer;

public class Application {
    public static void main(String[] args) {
        HttpServer server = FeatCloud.cloudServer(options -> {
            // CloudOptions ç‰¹æœ‰é…ç½®
            options.setPackages("com.example.controller");
            options.addExternalBean("dataSource", createDataSource());
            
            // ä» ServerOptions ç»§æ‰¿çš„é…ç½®
            options.serverName("example-app");
            options.threadNum(8);
            options.setIdleTimeout(30000);
            options.debug(false);
        });
        
        server.start();
    }
    
    private static Object createDataSource() {
        // åˆ›å»ºæ•°æ®æºçš„ä»£ç 
        return new Object();
    }
}
```

## é…ç½®æœ€ä½³å®è·µ

1. **æ€§èƒ½ä¼˜åŒ–**
   - æ ¹æ®åº”ç”¨ç‰¹æ€§åˆç†è®¾ç½®çº¿ç¨‹æ•°
   - æ˜ç¡®æŒ‡å®šåŒ…è·¯å¾„ï¼Œé¿å…å…¨å±€æ‰«æ
   - åœ¨ç”Ÿäº§ç¯å¢ƒå…³é—­è°ƒè¯•æ¨¡å¼

2. **èµ„æºç®¡ç†**
   - åˆç†è®¾ç½®ç©ºé—²è¶…æ—¶æ—¶é—´ï¼Œé¿å…èµ„æºæµªè´¹
   - ä½¿ç”¨å¤–éƒ¨Beanç®¡ç†å…±äº«èµ„æºï¼Œå¦‚æ•°æ®åº“è¿æ¥æ± 

3. **å®‰å…¨æ€§**
   - åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œè€ƒè™‘ä¿®æ”¹é»˜è®¤çš„æœåŠ¡å™¨åç§°ï¼Œå‡å°‘ä¿¡æ¯æ³„éœ²
   - è®¾ç½®åˆç†çš„è¯·æ±‚å¤§å°é™åˆ¶ï¼Œé˜²æ­¢æ¶æ„å¤§è¯·æ±‚æ”»å‡»
