---
title: Agent
description: Feat AI Agent 功能介绍
sidebar:
    order: 4
---

import Mermaid from '../../../components/Mermaid.astro';

Agent 是 Feat AI 框架中的一个重要组件，它基于 ReAct（Reasoning + Acting）范式，能够进行推理并执行动作。Agent 可以使用各种工具来完成复杂的任务，如文件操作、网络搜索、待办事项管理等。

## 核心概念

### ReAct 范式

ReAct 是一种结合推理（Reasoning）和行动（Acting）的范式，使 Agent 能够：

1. **思考（Thought）** - 分析当前情况和目标
2. **行动（Action）** - 执行具体的操作
3. **观察（Observation）** - 获取行动结果并据此继续推理

这种循环往复的过程让 Agent 能够解决复杂的多步骤任务。

<Mermaid code={`
graph TD
    A[开始] --> B[思考]
    B --> C[执行动作]
    C --> D[观察结果]
    D --> E{是否完成?}
    E -->|否| B
    E -->|是| F[返回最终答案]
`}/>

### Agent 状态

Agent 在执行过程中会经历以下状态：

- **IDLE** - 空闲状态
- **RUNNING** - 正在运行
- **TOOL_EXECUTION** - 正在执行工具
- **FINISHED** - 执行完成
- **ERROR** - 执行出错

## 快速开始

### 创建 Agent 实例

```java
import tech.smartboot.feat.ai.agent.ReActAgent;

// 创建一个 ReActAgent 实例
ReActAgent agent = new ReActAgent();
```

### 执行任务

```java
// 让 Agent 执行一个任务
String result = agent.execute("帮我搜索一下最新的 AI 技术发展趋势");
System.out.println(result);
```

## 配置选项

Agent 提供了丰富的配置选项，可通过 [AgentOptions](file:///Users/zhengjw22mac123/IdeaProjects/feat/feat-ai/src/main/java/tech/smartboot/feat/ai/agent/AgentOptions.java#L37-L268) 进行配置：

```java
import tech.smartboot.feat.ai.agent.AgentOptions;
import tech.smartboot.feat.ai.chat.ChatModelVendor;

AgentOptions options = AgentOptions.create()
    .name("MyAgent")                           // 设置 Agent 名称
    .description("一个通用的 AI Agent")          // 设置描述
    .model(ChatModelVendor.GiteeAI.DeepSeek_R1) // 设置使用的模型
    .maxIterations(10)                         // 设置最大推理迭代次数
    .enableSmartMemory();                      // 启用智能记忆检索
```

配置选项详解：

| 选项 | 描述 | 默认值 |
|------|------|--------|
| name | Agent 名称 | "DefaultAgent" |
| description | Agent 描述 | "默认Agent" |
| model | 使用的模型 | ChatModelVendor.GiteeAI.DeepSeek_V32_EXP |
| maxIterations | 最大推理迭代次数 | 20 |
| enableSmartMemory | 是否启用智能记忆检索 | true |

## 内置工具

Feat AI Agent 内置了多种常用工具：

### 待办事项工具 (TodoListTool)

管理待办事项列表：

```java
// 添加待办事项
Action: todo_list
Action Input: {
  "operation": "add",
  "title": "完成项目文档",
  "description": "编写 Feat AI 的使用文档"
}

// 列出所有待办事项
Action: todo_list
Action Input: {
  "operation": "list"
}
```

### 文件操作工具 (FileOperationTool)

执行文件系统操作：

```java
// 读取文件
Action: file_operation
Action Input: {
  "operation": "read",
  "path": "./README.md"
}

// 写入文件
Action: file_operation
Action Input: {
  "operation": "write",
  "path": "./output.txt",
  "content": "这是写入的内容"
}
```

### 搜索工具 (SearchTool)

执行网络搜索：

```java
// 搜索信息
Action: search
Action Input: {
  "query": "最新的 AI 技术发展趋势"
}
```

### 网页阅读工具 (WebPageReaderTool)

读取网页内容：

```java
// 读取网页
Action: web_page_reader
Action Input: {
  "url": "https://example.com/article"
}
```

### 子 Agent 工具 (SubAgentTool)

创建子 Agent 来处理特定任务：

```java
// 创建子 Agent
Action: sub_agent
Action Input: {
  "task": "分析这份报告的主要观点"
}
```

## 自定义工具

除了内置工具外，您还可以创建自定义工具：

```java
import tech.smartboot.feat.ai.agent.tool.ToolExecutor;
import com.alibaba.fastjson2.JSONObject;

public class CustomTool implements ToolExecutor {
    
    @Override
    public String execute(JSONObject parameters) {
        // 实现工具的具体逻辑
        return "工具执行结果";
    }
    
    @Override
    public String getName() {
        return "custom_tool";
    }
    
    @Override
    public String getDescription() {
        return "这是一个自定义工具";
    }
    
    @Override
    public String getParametersSchema() {
        // 返回参数定义的 JSON Schema
        return "{\n" +
               "  \"type\": \"object\",\n" +
               "  \"properties\": {\n" +
               "    \"param1\": {\"type\": \"string\"}\n" +
               "  }\n" +
               "}";
    }
}

// 注册自定义工具
agent.addTool(new CustomTool());
```

## 使用示例

### 完整示例

```java
import tech.smartboot.feat.ai.agent.ReActAgent;
import tech.smartboot.feat.ai.agent.AgentOptions;
import tech.smartboot.feat.ai.chat.ChatModelVendor;

public class AgentDemo {
    public static void main(String[] args) {
        // 创建 Agent 配置
        AgentOptions options = AgentOptions.create()
            .name("ResearchAssistant")
            .description("研究助理，可以帮助搜索和整理信息")
            .model(ChatModelVendor.GiteeAI.DeepSeek_R1)
            .maxIterations(15);
            
        // 创建 Agent 实例
        ReActAgent agent = new ReActAgent();
        
        // 执行任务
        String result = agent.execute("请帮我调研一下 AI 领域的最新进展，并整理成一份简要报告");
        System.out.println("任务结果:");
        System.out.println(result);
    }
}
```

有关完整示例，请参见 [ReActAgentTest.java](https://gitee.com/smartboot/feat/blob/master/feat-ai/src/test/java/tech/smartboot/feat/ai/agent/ReActAgentTest.java)

## 内存管理

Agent 具有内存管理功能，可以存储和检索相关信息：

```java
import tech.smartboot.feat.ai.agent.memory.AgentMemory;
import tech.smartboot.feat.ai.agent.memory.DefaultAgentMemory;

// 创建自定义内存管理器
AgentMemory memory = new DefaultAgentMemory();
agent.getOptions().memory(memory);

// 或者在创建 Agent 时配置
ReActAgent agent = new ReActAgent();
agent.getOptions()
    .memory(new DefaultAgentMemory())
    .enableSmartMemory()
    .memoryRetrievalThreshold(0.7)
    .maxMemoryRetrievalCount(10);
```

## 最佳实践

1. **合理设置迭代次数** - 根据任务复杂度设置合适的最大迭代次数，避免无限循环
2. **选择合适模型** - 根据任务需求选择具有相应能力的模型
3. **工具组合使用** - 合理组合不同工具以完成复杂任务
4. **监控 Agent 状态** - 通过状态监控了解 Agent 的执行过程
5. **错误处理** - 妥善处理执行过程中可能出现的异常情况

## 架构说明

ReActAgent 的工作原理如下：

1. 接收用户输入的任务
2. 使用预定义的提示模板构造系统提示
3. 调用配置的 AI 模型生成响应
4. 解析响应中的 Thought、Action 和 Action Input
5. 执行对应的工具操作
6. 将工具执行结果作为 Observation 添加到上下文中
7. 重复步骤 3-6 直到获得最终答案或达到最大迭代次数

## 总结

Feat AI Agent 为开发者提供了一个强大而灵活的框架，用于构建能够自主推理和执行任务的 AI 应用程序。通过内置工具和自定义扩展机制，可以满足各种复杂场景的需求。